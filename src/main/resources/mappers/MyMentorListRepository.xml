<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.DAO.MyMentorListMapper">

  <!-- 진행 중 멘토링 불러오기 -->
  <select id="findByMenteeId" parameterType="int" resultType="com.example.dto.MyMentorListDTO">
    SELECT
      mp.mentoring_progress_id AS progressId,
      mt.id AS mentorId,
      mt.name AS mentorName,
      mt.intro AS mentorIntro,
      mt.career AS career,
      mt.specialty AS specialty
    FROM mentoring_progress mp
    JOIN mentor mt ON mp.mentor_id = mt.id
    WHERE mp.mentee_id = #{menteeId}
      AND mp.connection_status = 'in_progress'
  </select>

  <!-- 멘토링 종료 -->
  <update id="endMentoring" parameterType="int">
    UPDATE mentoring_progress
    SET connection_status = 'ended',
        end_date = NOW()
    WHERE mentoring_progress_id = #{progressId}
      AND connection_status = 'in_progress'
  </update>

</mapper>
